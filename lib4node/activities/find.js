"use strict";
"use strict";
var util = require('util');
var Query = require('./query');
var MongoDBContext = require('./mongoDBContext');
function Find() {
  Query.call(this);
  this.toArray = false;
}
util.inherits(Find, Query);
Find.prototype.doQuery = function(callContext, query) {
  var coll = callContext.activity.getCollection(this);
  var cursor = coll.find(query || {}, this.get('options'));
  if (this.get("toArray")) {
    cursor.toArray(function(err, result) {
      if (err) {
        callContext.fail(err);
      } else {
        callContext.complete(result);
      }
      cursor.close();
    });
  } else {
    MongoDBContext.registerOpenedCursor(this, cursor);
    callContext.complete(cursor);
  }
};
module.exports = Find;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbmQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxXQUFXLENBQUM7QUFFWixBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztBQUMxQixBQUFJLEVBQUEsQ0FBQSxLQUFJLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxTQUFRLENBQUMsQ0FBQztBQUM5QixBQUFJLEVBQUEsQ0FBQSxjQUFhLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxrQkFBaUIsQ0FBQyxDQUFDO0FBRWhELE9BQVMsS0FBRyxDQUFFLEFBQUQsQ0FBRztBQUNaLE1BQUksS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFFaEIsS0FBRyxRQUFRLEVBQUksTUFBSSxDQUFDO0FBQ3hCO0FBQUEsQUFFQSxHQUFHLFNBQVMsQUFBQyxDQUFDLElBQUcsQ0FBRyxNQUFJLENBQUMsQ0FBQztBQUUxQixHQUFHLFVBQVUsUUFBUSxFQUFJLFVBQVMsV0FBVSxDQUFHLENBQUEsS0FBSSxDQUFHO0FBQ2xELEFBQUksSUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLFdBQVUsU0FBUyxjQUFjLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztBQUNuRCxBQUFJLElBQUEsQ0FBQSxNQUFLLEVBQUksQ0FBQSxJQUFHLEtBQUssQUFBQyxDQUFDLEtBQUksR0FBSyxHQUFDLENBQUcsQ0FBQSxJQUFHLElBQUksQUFBQyxDQUFDLFNBQVEsQ0FBQyxDQUFDLENBQUM7QUFDeEQsS0FBSSxJQUFHLElBQUksQUFBQyxDQUFDLFNBQVEsQ0FBQyxDQUFHO0FBQ3JCLFNBQUssUUFBUSxBQUFDLENBQUMsU0FBUyxHQUFFLENBQUcsQ0FBQSxNQUFLLENBQUc7QUFDakMsU0FBSSxHQUFFLENBQUc7QUFDTCxrQkFBVSxLQUFLLEFBQUMsQ0FBQyxHQUFFLENBQUMsQ0FBQztNQUN6QixLQUNLO0FBQ0Qsa0JBQVUsU0FBUyxBQUFDLENBQUMsTUFBSyxDQUFDLENBQUM7TUFDaEM7QUFBQSxBQUNBLFdBQUssTUFBTSxBQUFDLEVBQUMsQ0FBQztJQUNsQixDQUFDLENBQUM7RUFDTixLQUNLO0FBQ0QsaUJBQWEscUJBQXFCLEFBQUMsQ0FBQyxJQUFHLENBQUcsT0FBSyxDQUFDLENBQUM7QUFDakQsY0FBVSxTQUFTLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztFQUNoQztBQUFBLEFBQ0osQ0FBQTtBQUVBLEtBQUssUUFBUSxFQUFJLEtBQUcsQ0FBQztBQUFBIiwiZmlsZSI6ImFjdGl2aXRpZXMvZmluZC5qcyIsInNvdXJjZVJvb3QiOiJDOi9HSVQvbW9uZ28tY3J1bmNoL2xpYi8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbmxldCB1dGlsID0gcmVxdWlyZSgndXRpbCcpO1xyXG5sZXQgUXVlcnkgPSByZXF1aXJlKCcuL3F1ZXJ5Jyk7XHJcbmxldCBNb25nb0RCQ29udGV4dCA9IHJlcXVpcmUoJy4vbW9uZ29EQkNvbnRleHQnKTtcclxuXHJcbmZ1bmN0aW9uIEZpbmQoKSB7XHJcbiAgICBRdWVyeS5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMudG9BcnJheSA9IGZhbHNlO1xyXG59XHJcblxyXG51dGlsLmluaGVyaXRzKEZpbmQsIFF1ZXJ5KTtcclxuXHJcbkZpbmQucHJvdG90eXBlLmRvUXVlcnkgPSBmdW5jdGlvbihjYWxsQ29udGV4dCwgcXVlcnkpIHtcclxuICAgIGxldCBjb2xsID0gY2FsbENvbnRleHQuYWN0aXZpdHkuZ2V0Q29sbGVjdGlvbih0aGlzKTtcclxuICAgIGxldCBjdXJzb3IgPSBjb2xsLmZpbmQocXVlcnkgfHwge30sIHRoaXMuZ2V0KCdvcHRpb25zJykpO1xyXG4gICAgaWYgKHRoaXMuZ2V0KFwidG9BcnJheVwiKSkge1xyXG4gICAgICAgIGN1cnNvci50b0FycmF5KGZ1bmN0aW9uKGVyciwgcmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxDb250ZXh0LmZhaWwoZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNhbGxDb250ZXh0LmNvbXBsZXRlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY3Vyc29yLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBNb25nb0RCQ29udGV4dC5yZWdpc3Rlck9wZW5lZEN1cnNvcih0aGlzLCBjdXJzb3IpO1xyXG4gICAgICAgIGNhbGxDb250ZXh0LmNvbXBsZXRlKGN1cnNvcik7XHJcbiAgICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRmluZDsiXX0=
