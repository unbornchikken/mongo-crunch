"use strict";
var util = require("util");
var wf4node = require("workflow-4-node");
var Activity = wf4node.activities.Activity;
var path = require("path");
var _ = require("lodash");
function PayFields() {
  Activity.call(this);
}
util.inherits(PayFields, Activity);
PayFields.prototype.run = function(callContext, args) {
  callContext.schedule(args, "_argsGot");
};
PayFields.prototype._argsGot = function(callContext, reason, result) {
  if (reason !== Activity.states.complete) {
    callContext.end(reason, result);
    return;
  }
  var arr = [];
  var $__18 = true;
  var $__19 = false;
  var $__20 = undefined;
  try {
    for (var $__16 = void 0,
        $__15 = (result)[Symbol.iterator](); !($__18 = ($__16 = $__15.next()).done); $__18 = true) {
      var arg = $__16.value;
      {
        var $__11 = true;
        var $__12 = false;
        var $__13 = undefined;
        try {
          for (var $__9 = void 0,
              $__8 = ((_.isArray(arg) ? arg : [arg]))[Symbol.iterator](); !($__11 = ($__9 = $__8.next()).done); $__11 = true) {
            var stripe = $__9.value;
            {
              if (_.isArray(stripe.payFields)) {
                var $__4 = true;
                var $__5 = false;
                var $__6 = undefined;
                try {
                  for (var $__2 = void 0,
                      $__1 = (stripe.payFields)[Symbol.iterator](); !($__4 = ($__2 = $__1.next()).done); $__4 = true) {
                    var field = $__2.value;
                    {
                      arr.push(field);
                    }
                  }
                } catch ($__7) {
                  $__5 = true;
                  $__6 = $__7;
                } finally {
                  try {
                    if (!$__4 && $__1.return != null) {
                      $__1.return();
                    }
                  } finally {
                    if ($__5) {
                      throw $__6;
                    }
                  }
                }
              } else if (_.isString(stripe.payFields)) {
                arr.push(stripe.payFields);
              }
            }
          }
        } catch ($__14) {
          $__12 = true;
          $__13 = $__14;
        } finally {
          try {
            if (!$__11 && $__8.return != null) {
              $__8.return();
            }
          } finally {
            if ($__12) {
              throw $__13;
            }
          }
        }
      }
    }
  } catch ($__21) {
    $__19 = true;
    $__20 = $__21;
  } finally {
    try {
      if (!$__18 && $__15.return != null) {
        $__15.return();
      }
    } finally {
      if ($__19) {
        throw $__20;
      }
    }
  }
  arr = _.uniq(arr);
  var obj = {};
  var $__25 = true;
  var $__26 = false;
  var $__27 = undefined;
  try {
    for (var $__23 = void 0,
        $__22 = (arr)[Symbol.iterator](); !($__25 = ($__23 = $__22.next()).done); $__25 = true) {
      var f = $__23.value;
      {
        obj[f] = "$" + f;
      }
    }
  } catch ($__28) {
    $__26 = true;
    $__27 = $__28;
  } finally {
    try {
      if (!$__25 && $__22.return != null) {
        $__22.return();
      }
    } finally {
      if ($__26) {
        throw $__27;
      }
    }
  }
  callContext.complete(obj);
};
module.exports = PayFields;
//# sourceMappingURL=data:application/json;base64,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QUFBQSxJQUNGO0FBQUEsRUFDRjtBQUFBLEFBdUJKLFlBQVUsU0FBUyxBQUFDLENBQUMsR0FBRSxDQUFDLENBQUM7QUFDN0IsQ0FBQztBQUVELEtBQUssUUFBUSxFQUFJLFVBQVEsQ0FBQztBQUFBIiwiZmlsZSI6ImNvbWlzc2lvbi9hY3Rpdml0aWVzL3BheUZpZWxkcy5qcyIsInNvdXJjZVJvb3QiOiJleGFtcGxlcy9lczYiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbmxldCB1dGlsID0gcmVxdWlyZShcInV0aWxcIik7XHJcbmxldCB3ZjRub2RlID0gcmVxdWlyZShcIndvcmtmbG93LTQtbm9kZVwiKTtcclxubGV0IEFjdGl2aXR5ID0gd2Y0bm9kZS5hY3Rpdml0aWVzLkFjdGl2aXR5O1xyXG5sZXQgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xyXG5sZXQgXyA9IHJlcXVpcmUoXCJsb2Rhc2hcIik7XHJcblxyXG5mdW5jdGlvbiBQYXlGaWVsZHMoKSB7XHJcbiAgICBBY3Rpdml0eS5jYWxsKHRoaXMpO1xyXG59XHJcblxyXG51dGlsLmluaGVyaXRzKFBheUZpZWxkcywgQWN0aXZpdHkpO1xyXG5cclxuUGF5RmllbGRzLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoY2FsbENvbnRleHQsIGFyZ3MpIHtcclxuICAgIGNhbGxDb250ZXh0LnNjaGVkdWxlKGFyZ3MsIFwiX2FyZ3NHb3RcIik7XHJcbn07XHJcblxyXG5QYXlGaWVsZHMucHJvdG90eXBlLl9hcmdzR290ID0gZnVuY3Rpb24gKGNhbGxDb250ZXh0LCByZWFzb24sIHJlc3VsdCkge1xyXG4gICAgaWYgKHJlYXNvbiAhPT0gQWN0aXZpdHkuc3RhdGVzLmNvbXBsZXRlKSB7XHJcbiAgICAgICAgY2FsbENvbnRleHQuZW5kKHJlYXNvbiwgcmVzdWx0KTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGFyciA9IFtdO1xyXG4gICAgZm9yIChsZXQgYXJnIG9mIHJlc3VsdCkge1xyXG4gICAgICAgIGZvciAobGV0IHN0cmlwZSBvZiAoXy5pc0FycmF5KGFyZykgPyBhcmcgOiBbYXJnXSkpIHtcclxuICAgICAgICAgICAgaWYgKF8uaXNBcnJheShzdHJpcGUucGF5RmllbGRzKSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgZmllbGQgb2Ygc3RyaXBlLnBheUZpZWxkcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKGZpZWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChfLmlzU3RyaW5nKHN0cmlwZS5wYXlGaWVsZHMpKSB7XHJcbiAgICAgICAgICAgICAgICBhcnIucHVzaChzdHJpcGUucGF5RmllbGRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFyciA9IF8udW5pcShhcnIpO1xyXG4gICAgbGV0IG9iaiA9IHt9O1xyXG4gICAgZm9yIChsZXQgZiBvZiBhcnIpIHtcclxuICAgICAgICBvYmpbZl0gPSBcIiRcIiArIGY7XHJcbiAgICB9XHJcbiAgICBjYWxsQ29udGV4dC5jb21wbGV0ZShvYmopO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQYXlGaWVsZHM7Il19
