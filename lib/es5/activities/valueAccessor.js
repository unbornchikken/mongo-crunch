"use strict";
"use strict";
var _ = require("lodash");
function ValueAccessor() {
  this._cache = new Map();
}
ValueAccessor.prototype.get = function(obj, path) {
  if (!_.isObject(obj)) {
    throw new TypeError("Argument 'obj' is not an object.");
  }
  if (!_.isString(path)) {
    throw new TypeError("Argument 'path' is not a string.");
  }
  path = path.replace(/\.$\./g, "[0]").trim();
  if (!path) {
    throw new Error("Value of argument 'path' expected.");
  }
  var parser = this._cache.get(path);
  if (!parser) {
    this._cache.set(path, parser = this._createParser(path));
  }
  return parser.call(obj);
};
ValueAccessor.prototype._createParser = function(path) {
  if (path.indexOf("this") !== 0) {
    if (path[0] === "[") {
      path = "this" + path;
    } else {
      path = "this." + path;
    }
  }
  return new Function("return " + path + ";");
};
module.exports = ValueAccessor;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZhbHVlQWNjZXNzb3IuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxXQUFXLENBQUM7QUFFWixBQUFJLEVBQUEsQ0FBQSxDQUFBLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxRQUFPLENBQUMsQ0FBQztBQUV6QixPQUFTLGNBQVksQ0FBRSxBQUFELENBQUc7QUFDckIsS0FBRyxPQUFPLEVBQUksSUFBSSxJQUFFLEFBQUMsRUFBQyxDQUFDO0FBQzNCO0FBQUEsQUFFQSxZQUFZLFVBQVUsSUFBSSxFQUFJLFVBQVMsR0FBRSxDQUFHLENBQUEsSUFBRyxDQUFHO0FBQzlDLEtBQUksQ0FBQyxDQUFBLFNBQVMsQUFBQyxDQUFDLEdBQUUsQ0FBQyxDQUFHO0FBQ2xCLFFBQU0sSUFBSSxVQUFRLEFBQUMsQ0FBQyxrQ0FBaUMsQ0FBQyxDQUFDO0VBQzNEO0FBQUEsQUFFQSxLQUFJLENBQUMsQ0FBQSxTQUFTLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBRztBQUNuQixRQUFNLElBQUksVUFBUSxBQUFDLENBQUMsa0NBQWlDLENBQUMsQ0FBQztFQUMzRDtBQUFBLEFBRUEsS0FBRyxFQUFJLENBQUEsSUFBRyxRQUFRLEFBQUMsQ0FBQyxRQUFPLENBQUcsTUFBSSxDQUFDLEtBQUssQUFBQyxFQUFDLENBQUM7QUFFM0MsS0FBSSxDQUFDLElBQUcsQ0FBRztBQUNQLFFBQU0sSUFBSSxNQUFJLEFBQUMsQ0FBQyxvQ0FBbUMsQ0FBQyxDQUFDO0VBQ3pEO0FBQUEsQUFFSSxJQUFBLENBQUEsTUFBSyxFQUFJLENBQUEsSUFBRyxPQUFPLElBQUksQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO0FBQ2xDLEtBQUksQ0FBQyxNQUFLLENBQUc7QUFDVCxPQUFHLE9BQU8sSUFBSSxBQUFDLENBQUMsSUFBRyxDQUFHLENBQUEsTUFBSyxFQUFJLENBQUEsSUFBRyxjQUFjLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQyxDQUFDO0VBQzVEO0FBQUEsQUFFQSxPQUFPLENBQUEsTUFBSyxLQUFLLEFBQUMsQ0FBQyxHQUFFLENBQUMsQ0FBQztBQUMzQixDQUFDO0FBRUQsWUFBWSxVQUFVLGNBQWMsRUFBSSxVQUFTLElBQUcsQ0FBRztBQUNuRCxLQUFJLElBQUcsUUFBUSxBQUFDLENBQUMsTUFBSyxDQUFDLENBQUEsR0FBTSxFQUFBLENBQUc7QUFDNUIsT0FBSSxJQUFHLENBQUUsQ0FBQSxDQUFDLElBQU0sSUFBRSxDQUFHO0FBQ2pCLFNBQUcsRUFBSSxDQUFBLE1BQUssRUFBSSxLQUFHLENBQUM7SUFDeEIsS0FDSztBQUNELFNBQUcsRUFBSSxDQUFBLE9BQU0sRUFBSSxLQUFHLENBQUM7SUFDekI7QUFBQSxFQUNKO0FBQUEsQUFFQSxPQUFPLElBQUksU0FBTyxBQUFDLENBQUMsU0FBUSxFQUFJLEtBQUcsQ0FBQSxDQUFJLElBQUUsQ0FBQyxDQUFDO0FBQy9DLENBQUM7QUFFRCxLQUFLLFFBQVEsRUFBSSxjQUFZLENBQUM7QUFBQSIsImZpbGUiOiJhY3Rpdml0aWVzL3ZhbHVlQWNjZXNzb3IuanMiLCJzb3VyY2VSb290IjoibGliL2VzNiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxubGV0IF8gPSByZXF1aXJlKFwibG9kYXNoXCIpO1xyXG5cclxuZnVuY3Rpb24gVmFsdWVBY2Nlc3NvcigpIHtcclxuICAgIHRoaXMuX2NhY2hlID0gbmV3IE1hcCgpO1xyXG59XHJcblxyXG5WYWx1ZUFjY2Vzc29yLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihvYmosIHBhdGgpIHtcclxuICAgIGlmICghXy5pc09iamVjdChvYmopKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFyZ3VtZW50ICdvYmonIGlzIG5vdCBhbiBvYmplY3QuXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghXy5pc1N0cmluZyhwYXRoKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcmd1bWVudCAncGF0aCcgaXMgbm90IGEgc3RyaW5nLlwiKTtcclxuICAgIH1cclxuXHJcbiAgICBwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC4kXFwuL2csIFwiWzBdXCIpLnRyaW0oKTtcclxuXHJcbiAgICBpZiAoIXBhdGgpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBvZiBhcmd1bWVudCAncGF0aCcgZXhwZWN0ZWQuXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBwYXJzZXIgPSB0aGlzLl9jYWNoZS5nZXQocGF0aCk7XHJcbiAgICBpZiAoIXBhcnNlcikge1xyXG4gICAgICAgIHRoaXMuX2NhY2hlLnNldChwYXRoLCBwYXJzZXIgPSB0aGlzLl9jcmVhdGVQYXJzZXIocGF0aCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBwYXJzZXIuY2FsbChvYmopO1xyXG59O1xyXG5cclxuVmFsdWVBY2Nlc3Nvci5wcm90b3R5cGUuX2NyZWF0ZVBhcnNlciA9IGZ1bmN0aW9uKHBhdGgpIHtcclxuICAgIGlmIChwYXRoLmluZGV4T2YoXCJ0aGlzXCIpICE9PSAwKSB7XHJcbiAgICAgICAgaWYgKHBhdGhbMF0gPT09IFwiW1wiKSB7XHJcbiAgICAgICAgICAgIHBhdGggPSBcInRoaXNcIiArIHBhdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXRoID0gXCJ0aGlzLlwiICsgcGF0aDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcInJldHVybiBcIiArIHBhdGggKyBcIjtcIik7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFZhbHVlQWNjZXNzb3I7Il19
