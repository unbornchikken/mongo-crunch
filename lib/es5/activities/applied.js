"use strict";
var wf4node = require("workflow-4-node");
var Activity = wf4node.activities.Activity;
var CollectionOp = require("./collectionOp");
var util = require("util");
function Applied() {
  CollectionOp.call(this);
  this.query = null;
  this.fields = null;
  this.name = null;
  this.flat = true;
}
util.inherits(Applied, CollectionOp);
Object.defineProperties(Applied.prototype, {
  collectionify: {
    value: true,
    enumerable: false
  },
  type: {
    get: function() {
      throw new Error("Not implemented.");
    },
    enumerable: false
  }
});
Applied.prototype.doWork = function(callContext) {
  callContext.schedule([this.query, this.fields, this.type, this.name, this.flat], "_parsGot");
};
Applied.prototype._parsGot = function(callContext, reason, result) {
  if (reason === Activity.states.complete) {
    var pars = {
      collection: this.getCollection.call(this, false),
      query: result[0],
      fields: result[1],
      type: result[2],
      name: result[3],
      flat: result[4]
    };
    callContext.complete(pars);
  } else {
    callContext.end(reason, result);
  }
};
module.exports = Applied;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcGxpZWQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFFQSxBQUFJLEVBQUEsQ0FBQSxPQUFNLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxpQkFBZ0IsQ0FBQyxDQUFDO0FBQ3hDLEFBQUksRUFBQSxDQUFBLFFBQU8sRUFBSSxDQUFBLE9BQU0sV0FBVyxTQUFTLENBQUM7QUFDMUMsQUFBSSxFQUFBLENBQUEsWUFBVyxFQUFJLENBQUEsT0FBTSxBQUFDLENBQUMsZ0JBQWUsQ0FBQyxDQUFDO0FBQzVDLEFBQUksRUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLE1BQUssQ0FBQyxDQUFDO0FBRTFCLE9BQVMsUUFBTSxDQUFFLEFBQUQsQ0FBRztBQUNmLGFBQVcsS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFDdkIsS0FBRyxNQUFNLEVBQUksS0FBRyxDQUFDO0FBQ2pCLEtBQUcsT0FBTyxFQUFJLEtBQUcsQ0FBQztBQUNsQixLQUFHLEtBQUssRUFBSSxLQUFHLENBQUM7QUFDaEIsS0FBRyxLQUFLLEVBQUksS0FBRyxDQUFDO0FBQ3BCO0FBQUEsQUFFQSxHQUFHLFNBQVMsQUFBQyxDQUFDLE9BQU0sQ0FBRyxhQUFXLENBQUMsQ0FBQztBQUVwQyxLQUFLLGlCQUFpQixBQUFDLENBQUMsT0FBTSxVQUFVLENBQUc7QUFDdkMsY0FBWSxDQUFHO0FBQ1gsUUFBSSxDQUFHLEtBQUc7QUFDVixhQUFTLENBQUcsTUFBSTtBQUFBLEVBQ3BCO0FBQ0EsS0FBRyxDQUFHO0FBQ0YsTUFBRSxDQUFHLFVBQVMsQUFBRCxDQUFHO0FBQ1osVUFBTSxJQUFJLE1BQUksQUFBQyxDQUFDLGtCQUFpQixDQUFDLENBQUM7SUFDdkM7QUFDQSxhQUFTLENBQUcsTUFBSTtBQUFBLEVBQ3BCO0FBQUEsQUFDSixDQUFDLENBQUM7QUFFRixNQUFNLFVBQVUsT0FBTyxFQUFJLFVBQVUsV0FBVSxDQUFHO0FBQzlDLFlBQVUsU0FBUyxBQUFDLENBQUMsQ0FBQyxJQUFHLE1BQU0sQ0FBRyxDQUFBLElBQUcsT0FBTyxDQUFHLENBQUEsSUFBRyxLQUFLLENBQUcsQ0FBQSxJQUFHLEtBQUssQ0FBRyxDQUFBLElBQUcsS0FBSyxDQUFDLENBQUcsV0FBUyxDQUFDLENBQUM7QUFDaEcsQ0FBQztBQUVELE1BQU0sVUFBVSxTQUFTLEVBQUksVUFBVSxXQUFVLENBQUcsQ0FBQSxNQUFLLENBQUcsQ0FBQSxNQUFLLENBQUc7QUFDaEUsS0FBSSxNQUFLLElBQU0sQ0FBQSxRQUFPLE9BQU8sU0FBUyxDQUFHO0FBQ3JDLEFBQUksTUFBQSxDQUFBLElBQUcsRUFBSTtBQUNQLGVBQVMsQ0FBRyxDQUFBLElBQUcsY0FBYyxLQUFLLEFBQUMsQ0FBQyxJQUFHLENBQUcsTUFBSSxDQUFDO0FBQy9DLFVBQUksQ0FBRyxDQUFBLE1BQUssQ0FBRSxDQUFBLENBQUM7QUFDZixXQUFLLENBQUcsQ0FBQSxNQUFLLENBQUUsQ0FBQSxDQUFDO0FBQ2hCLFNBQUcsQ0FBRyxDQUFBLE1BQUssQ0FBRSxDQUFBLENBQUM7QUFDZCxTQUFHLENBQUcsQ0FBQSxNQUFLLENBQUUsQ0FBQSxDQUFDO0FBQ2QsU0FBRyxDQUFHLENBQUEsTUFBSyxDQUFFLENBQUEsQ0FBQztBQUFBLElBQ2xCLENBQUM7QUFDRCxjQUFVLFNBQVMsQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO0VBQzlCLEtBQ0s7QUFDRCxjQUFVLElBQUksQUFBQyxDQUFDLE1BQUssQ0FBRyxPQUFLLENBQUMsQ0FBQztFQUNuQztBQUFBLEFBQ0osQ0FBQztBQUVELEtBQUssUUFBUSxFQUFJLFFBQU0sQ0FBQztBQUFBIiwiZmlsZSI6ImFjdGl2aXRpZXMvYXBwbGllZC5qcyIsInNvdXJjZVJvb3QiOiJsaWIvZXM2Iiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5sZXQgd2Y0bm9kZSA9IHJlcXVpcmUoXCJ3b3JrZmxvdy00LW5vZGVcIik7XHJcbmxldCBBY3Rpdml0eSA9IHdmNG5vZGUuYWN0aXZpdGllcy5BY3Rpdml0eTtcclxubGV0IENvbGxlY3Rpb25PcCA9IHJlcXVpcmUoXCIuL2NvbGxlY3Rpb25PcFwiKTtcclxubGV0IHV0aWwgPSByZXF1aXJlKFwidXRpbFwiKTtcclxuXHJcbmZ1bmN0aW9uIEFwcGxpZWQoKSB7XHJcbiAgICBDb2xsZWN0aW9uT3AuY2FsbCh0aGlzKTtcclxuICAgIHRoaXMucXVlcnkgPSBudWxsO1xyXG4gICAgdGhpcy5maWVsZHMgPSBudWxsO1xyXG4gICAgdGhpcy5uYW1lID0gbnVsbDtcclxuICAgIHRoaXMuZmxhdCA9IHRydWU7XHJcbn1cclxuXHJcbnV0aWwuaW5oZXJpdHMoQXBwbGllZCwgQ29sbGVjdGlvbk9wKTtcclxuXHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKEFwcGxpZWQucHJvdG90eXBlLCB7XHJcbiAgICBjb2xsZWN0aW9uaWZ5OiB7XHJcbiAgICAgICAgdmFsdWU6IHRydWUsXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2VcclxuICAgIH0sXHJcbiAgICB0eXBlOiB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudGVkLlwiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlXHJcbiAgICB9XHJcbn0pO1xyXG5cclxuQXBwbGllZC5wcm90b3R5cGUuZG9Xb3JrID0gZnVuY3Rpb24gKGNhbGxDb250ZXh0KSB7XHJcbiAgICBjYWxsQ29udGV4dC5zY2hlZHVsZShbdGhpcy5xdWVyeSwgdGhpcy5maWVsZHMsIHRoaXMudHlwZSwgdGhpcy5uYW1lLCB0aGlzLmZsYXRdLCBcIl9wYXJzR290XCIpO1xyXG59O1xyXG5cclxuQXBwbGllZC5wcm90b3R5cGUuX3BhcnNHb3QgPSBmdW5jdGlvbiAoY2FsbENvbnRleHQsIHJlYXNvbiwgcmVzdWx0KSB7XHJcbiAgICBpZiAocmVhc29uID09PSBBY3Rpdml0eS5zdGF0ZXMuY29tcGxldGUpIHtcclxuICAgICAgICBsZXQgcGFycyA9IHtcclxuICAgICAgICAgICAgY29sbGVjdGlvbjogdGhpcy5nZXRDb2xsZWN0aW9uLmNhbGwodGhpcywgZmFsc2UpLCAvLyBDYW4gYmUgbnVsbFxyXG4gICAgICAgICAgICBxdWVyeTogcmVzdWx0WzBdLFxyXG4gICAgICAgICAgICBmaWVsZHM6IHJlc3VsdFsxXSxcclxuICAgICAgICAgICAgdHlwZTogcmVzdWx0WzJdLFxyXG4gICAgICAgICAgICBuYW1lOiByZXN1bHRbM10sXHJcbiAgICAgICAgICAgIGZsYXQ6IHJlc3VsdFs0XVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2FsbENvbnRleHQuY29tcGxldGUocGFycyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjYWxsQ29udGV4dC5lbmQocmVhc29uLCByZXN1bHQpO1xyXG4gICAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBBcHBsaWVkOyJdfQ==
