"use strict";
"use strict";
var wf4node = require("workflow-4-node");
var Activity = wf4node.activities.Activity;
var CollectionOp = require("./collectionOp");
var util = require("util");
function Applied() {
  CollectionOp.call(this);
  this.query = null;
  this.fields = null;
  this.name = null;
  this.flat = true;
}
util.inherits(Applied, CollectionOp);
Object.defineProperties(Applied.prototype, {
  collectionify: {
    value: true,
    enumerable: false
  },
  type: {
    get: function() {
      throw new Error("Not implemented.");
    },
    enumerable: false
  }
});
Applied.prototype.doWork = function(callContext) {
  callContext.schedule([this.query, this.fields, this.type, this.name, this.flat], "_parsGot");
};
Applied.prototype._parsGot = function(callContext, reason, result) {
  if (reason === Activity.states.complete) {
    var pars = {
      collection: this.getCollection.call(this, false),
      query: result[0],
      fields: result[1],
      type: result[2],
      name: result[3],
      flat: result[4]
    };
    callContext.complete(pars);
  } else {
    callContext.end(reason, result);
  }
};
module.exports = Applied;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcGxpZWQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxXQUFXLENBQUM7QUFFWixBQUFJLEVBQUEsQ0FBQSxPQUFNLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxpQkFBZ0IsQ0FBQyxDQUFDO0FBQ3hDLEFBQUksRUFBQSxDQUFBLFFBQU8sRUFBSSxDQUFBLE9BQU0sV0FBVyxTQUFTLENBQUM7QUFDMUMsQUFBSSxFQUFBLENBQUEsWUFBVyxFQUFJLENBQUEsT0FBTSxBQUFDLENBQUMsZ0JBQWUsQ0FBQyxDQUFDO0FBQzVDLEFBQUksRUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLE1BQUssQ0FBQyxDQUFDO0FBRTFCLE9BQVMsUUFBTSxDQUFFLEFBQUQsQ0FBRztBQUNmLGFBQVcsS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFDdkIsS0FBRyxNQUFNLEVBQUksS0FBRyxDQUFDO0FBQ2pCLEtBQUcsT0FBTyxFQUFJLEtBQUcsQ0FBQztBQUNsQixLQUFHLEtBQUssRUFBSSxLQUFHLENBQUM7QUFDaEIsS0FBRyxLQUFLLEVBQUksS0FBRyxDQUFDO0FBQ3BCO0FBQUEsQUFFQSxHQUFHLFNBQVMsQUFBQyxDQUFDLE9BQU0sQ0FBRyxhQUFXLENBQUMsQ0FBQztBQUVwQyxLQUFLLGlCQUFpQixBQUFDLENBQUMsT0FBTSxVQUFVLENBQUc7QUFDdkMsY0FBWSxDQUFHO0FBQ1gsUUFBSSxDQUFHLEtBQUc7QUFDVixhQUFTLENBQUcsTUFBSTtBQUFBLEVBQ3BCO0FBQ0EsS0FBRyxDQUFHO0FBQ0YsTUFBRSxDQUFHLFVBQVMsQUFBRCxDQUFHO0FBQ1osVUFBTSxJQUFJLE1BQUksQUFBQyxDQUFDLGtCQUFpQixDQUFDLENBQUM7SUFDdkM7QUFDQSxhQUFTLENBQUcsTUFBSTtBQUFBLEVBQ3BCO0FBQUEsQUFDSixDQUFDLENBQUM7QUFFRixNQUFNLFVBQVUsT0FBTyxFQUFJLFVBQVUsV0FBVSxDQUFHO0FBQzlDLFlBQVUsU0FBUyxBQUFDLENBQUMsQ0FBQyxJQUFHLE1BQU0sQ0FBRyxDQUFBLElBQUcsT0FBTyxDQUFHLENBQUEsSUFBRyxLQUFLLENBQUcsQ0FBQSxJQUFHLEtBQUssQ0FBRyxDQUFBLElBQUcsS0FBSyxDQUFDLENBQUcsV0FBUyxDQUFDLENBQUM7QUFDaEcsQ0FBQztBQUVELE1BQU0sVUFBVSxTQUFTLEVBQUksVUFBVSxXQUFVLENBQUcsQ0FBQSxNQUFLLENBQUcsQ0FBQSxNQUFLLENBQUc7QUFDaEUsS0FBSSxNQUFLLElBQU0sQ0FBQSxRQUFPLE9BQU8sU0FBUyxDQUFHO0FBQ3JDLEFBQUksTUFBQSxDQUFBLElBQUcsRUFBSTtBQUNQLGVBQVMsQ0FBRyxDQUFBLElBQUcsY0FBYyxLQUFLLEFBQUMsQ0FBQyxJQUFHLENBQUcsTUFBSSxDQUFDO0FBQy9DLFVBQUksQ0FBRyxDQUFBLE1BQUssQ0FBRSxDQUFBLENBQUM7QUFDZixXQUFLLENBQUcsQ0FBQSxNQUFLLENBQUUsQ0FBQSxDQUFDO0FBQ2hCLFNBQUcsQ0FBRyxDQUFBLE1BQUssQ0FBRSxDQUFBLENBQUM7QUFDZCxTQUFHLENBQUcsQ0FBQSxNQUFLLENBQUUsQ0FBQSxDQUFDO0FBQ2QsU0FBRyxDQUFHLENBQUEsTUFBSyxDQUFFLENBQUEsQ0FBQztBQUFBLElBQ2xCLENBQUM7QUFDRCxjQUFVLFNBQVMsQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO0VBQzlCLEtBQ0s7QUFDRCxjQUFVLElBQUksQUFBQyxDQUFDLE1BQUssQ0FBRyxPQUFLLENBQUMsQ0FBQztFQUNuQztBQUFBLEFBQ0osQ0FBQztBQUVELEtBQUssUUFBUSxFQUFJLFFBQU0sQ0FBQztBQUFBIiwiZmlsZSI6ImFjdGl2aXRpZXMvYXBwbGllZC5qcyIsInNvdXJjZVJvb3QiOiJsaWIvZXM2Iiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmxldCB3ZjRub2RlID0gcmVxdWlyZShcIndvcmtmbG93LTQtbm9kZVwiKTtcbmxldCBBY3Rpdml0eSA9IHdmNG5vZGUuYWN0aXZpdGllcy5BY3Rpdml0eTtcbmxldCBDb2xsZWN0aW9uT3AgPSByZXF1aXJlKFwiLi9jb2xsZWN0aW9uT3BcIik7XG5sZXQgdXRpbCA9IHJlcXVpcmUoXCJ1dGlsXCIpO1xuXG5mdW5jdGlvbiBBcHBsaWVkKCkge1xuICAgIENvbGxlY3Rpb25PcC5jYWxsKHRoaXMpO1xuICAgIHRoaXMucXVlcnkgPSBudWxsO1xuICAgIHRoaXMuZmllbGRzID0gbnVsbDtcbiAgICB0aGlzLm5hbWUgPSBudWxsO1xuICAgIHRoaXMuZmxhdCA9IHRydWU7XG59XG5cbnV0aWwuaW5oZXJpdHMoQXBwbGllZCwgQ29sbGVjdGlvbk9wKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoQXBwbGllZC5wcm90b3R5cGUsIHtcbiAgICBjb2xsZWN0aW9uaWZ5OiB7XG4gICAgICAgIHZhbHVlOiB0cnVlLFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxuICAgIH0sXG4gICAgdHlwZToge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudGVkLlwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2VcbiAgICB9XG59KTtcblxuQXBwbGllZC5wcm90b3R5cGUuZG9Xb3JrID0gZnVuY3Rpb24gKGNhbGxDb250ZXh0KSB7XG4gICAgY2FsbENvbnRleHQuc2NoZWR1bGUoW3RoaXMucXVlcnksIHRoaXMuZmllbGRzLCB0aGlzLnR5cGUsIHRoaXMubmFtZSwgdGhpcy5mbGF0XSwgXCJfcGFyc0dvdFwiKTtcbn07XG5cbkFwcGxpZWQucHJvdG90eXBlLl9wYXJzR290ID0gZnVuY3Rpb24gKGNhbGxDb250ZXh0LCByZWFzb24sIHJlc3VsdCkge1xuICAgIGlmIChyZWFzb24gPT09IEFjdGl2aXR5LnN0YXRlcy5jb21wbGV0ZSkge1xuICAgICAgICBsZXQgcGFycyA9IHtcbiAgICAgICAgICAgIGNvbGxlY3Rpb246IHRoaXMuZ2V0Q29sbGVjdGlvbi5jYWxsKHRoaXMsIGZhbHNlKSwgLy8gQ2FuIGJlIG51bGxcbiAgICAgICAgICAgIHF1ZXJ5OiByZXN1bHRbMF0sXG4gICAgICAgICAgICBmaWVsZHM6IHJlc3VsdFsxXSxcbiAgICAgICAgICAgIHR5cGU6IHJlc3VsdFsyXSxcbiAgICAgICAgICAgIG5hbWU6IHJlc3VsdFszXSxcbiAgICAgICAgICAgIGZsYXQ6IHJlc3VsdFs0XVxuICAgICAgICB9O1xuICAgICAgICBjYWxsQ29udGV4dC5jb21wbGV0ZShwYXJzKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNhbGxDb250ZXh0LmVuZChyZWFzb24sIHJlc3VsdCk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBBcHBsaWVkOyJdfQ==
